# CDK Diagram Generator MCP Server Tests

This directory contains tests for the CDK Diagram Generator MCP Server. The tests are organized into basic tests and comprehensive tests for each component of the server.

## Test Structure

- **Basic Tests**: Simple tests that verify the basic functionality of each component.
  - `typescript-parser.test.js`: Tests the TypeScript parser
  - `python-parser.test.js`: Tests the Python parser
  - `drawio-generator.test.js`: Tests the DrawIO generator
  - `mcp-server.test.js`: Tests the MCP server

- **Comprehensive Tests**: More thorough tests that cover edge cases and additional functionality.
  - `typescript-parser-comprehensive.test.js`: Comprehensive tests for the TypeScript parser
  - `python-parser-comprehensive.test.js`: Comprehensive tests for the Python parser
  - `drawio-generator-comprehensive.test.js`: Comprehensive tests for the DrawIO generator
  - `mcp-server-comprehensive.test.js`: Comprehensive tests for the MCP server

## Running Tests

You can run all tests using the following command:

```bash
npm test
```

This will run all tests and display a summary of the results.

You can also run individual tests using the following commands:

```bash
# Basic tests
npm run test:typescript-parser
npm run test:python-parser
npm run test:drawio-generator
npm run test:mcp-server

# Comprehensive tests
npm run test:comprehensive
```

## Test Implementation

The tests use the following approach:

- **Parser Tests**: Test the parsers by parsing example CDK code and verifying that the resulting infrastructure model contains the expected resources and connections.

- **Generator Tests**: Test the generator by creating an infrastructure model and verifying that the resulting diagram XML contains the expected elements.

- **MCP Server Tests**: Test the MCP server by mocking the server's request handlers and verifying that they return the expected responses.

## Adding New Tests

To add a new test:

1. Create a new test file in the `tests` directory.
2. Import the necessary modules and functions.
3. Write your test code.
4. Add the test to the `testFiles` array in `run-tests.js`.
5. Add a script to `package.json` to run the test individually.

## Test Output

The tests generate output files in the `output` directory. These files include:

- DrawIO diagrams generated by the tests
- Other temporary files created during testing

You can examine these files to verify that the tests are working correctly.
